V 10
1
LANG:1 8 (NoName)
PANEL,428 148 624 430 N "_3DFace" 1
"$sDpName"
EEE E E 1 -1 -1 0  10 10
"" 0 1
EE 2
"CBRef""1"
"EClose"E
""
NC
DISPLAY_LAYER, 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
LAYER, 0 
1
LANG:1 6 Layer1
2 7
"lblTitle"
""
1 10 10 E E E 1 E 1 E N "_3DText" E N "_3DFace" E E
 E E
7 0 0 0 0 0
EE E
0
1
LANG:1 0 
1
"dashclr"N "_Transparent"
E E 0 1 1 0 1 E U  1 E 12 12 128 34
0 2 0 "s" 0 0 0 64 0 0  12 12
 1
1
LANG:1 107 -microsoft windows-Arial-normal-r-normal-*-*-160-100-100-*-*-iso8859-1|-19,0,0,0,400,0,0,0,0,3,2,1,34,Arial
0 ""
1
LANG:1 10 Manage SPI
2 9
"txtMessage"
""
1 10 90 E E E 1 E 1 E N "_WindowText" E N "_Transparent" E E
 E E
8 0 0 0 0 0
EE E
0
1
LANG:1 0 
1
"dashclr"N "_Transparent"
E E 0 1 1 0 1 E U  0 E 12 92 398 118
0 2 0 "s" 0 0 0 64 0 0  12 92
 1
1
LANG:1 107 -microsoft windows-Arial-normal-r-normal-*-*-120-100-100-*-*-iso8859-1|-13,0,0,0,400,0,0,0,0,3,2,1,34,Arial
0 ""
1
LANG:1 0 
2 10
"lblComment"
""
1 10 50 E E E 1 E 1 E N {0,0,0} E N "_Transparent" E E
 E E
9 0 0 0 0 0
EE E
0
1
LANG:1 0 
1
"dashclr"N "_Transparent"
E E 0 1 1 0 1 E U  0 E 12 52 68 68
0 2 0 "s" 0 0 0 192 0 0  12 52
 1
1
LANG:1 107 -microsoft windows-Arial-normal-r-normal-*-*-120-100-100-*-*-iso8859-1|-13,0,0,0,400,0,0,0,0,3,2,1,34,Arial
0 ""
1
LANG:1 7 Comment
30 11
"frmOpcAddressing"
""
1 10 380 E E E 1 E 1 E N "_3DText" E N "_Transparent" E E
 E E
10 0 0 0 0 0
EE E
1
2
LANG:1 0 
LANG:5 0 
0
E E 0 1 1 0 1 E U  0 E 10 330 614 380
2
LANG:1 107 -microsoft windows-Arial-normal-r-normal-*-*-120-100-100-*-*-iso8859-1|-13,0,0,0,400,0,0,0,0,3,2,1,34,Arial
LANG:5 107 -microsoft windows-Arial-normal-r-normal-*-*-120-100-100-*-*-iso8859-1|-13,0,0,0,400,0,0,0,0,3,2,1,34,Arial
0 ""
2
LANG:1 0 
LANG:5 0 
13 2
"cmdCreate"
""
1 420 390 E E E 1 E 1 E N "_3DText" E N "_3DFace" E E
 E E
3 0 0 0 0 0
EE E
0
1
LANG:1 0 
0
1
LANG:1 107 -microsoft windows-Arial-normal-r-normal-*-*-120-100-100-*-*-iso8859-1|-13,0,0,0,400,0,0,0,0,3,2,1,34,Arial
0 ""
418 388 481 417
T 
1
LANG:1 6 Create
"main()
{
// Local Variables
// ---------------
	bool bOPCaddressing;
	
	string sSubDpName;
	string sBusName;
	string sElmbName;
	string sSPIname;
	string sComment;
	
	dyn_string dsTemp;
	dyn_string dsExceptionInfo;
	
// Executable Code
// ---------------
	// Show progress bar to indicate system is busy
	fwOpenProgressBar(\"Create SPI\", \"In progress. Please wait...\", 1);
	
	// Remove system name if it has been given
	sSubDpName = dpSubStr($sDpName, DPSUB_DP);

	// Get Bus and ELMB name
	dsTemp = strsplit(sSubDpName, fwDevice_HIERARCHY_SEPARATOR);
	sBusName = dsTemp[2];
	sElmbName = dsTemp[dynlen(dsTemp)];
	bOPCaddressing = chbOpcAddressing.state(0);
	sComment = txtComment.text;
	
	// Create SPI communication DP
	sSPIname = fwElmbUser_createSPI(sBusName,
																	sElmbName,
																	sComment,
																	bOPCaddressing,
																	dsExceptionInfo);
	
	// Check for errors																
	if (dynlen(dsExceptionInfo) > 0) {
		fwCloseProgressBar(\"SPI creation encountered errors\");
		fwExceptionHandling_display(dsExceptionInfo);
	} else {
		fwCloseProgressBar(\"SPI creation completed successfully\");
	}	
	
	// Return to calling routine
	return;
}" 0
 E E E
13 3
"cmdDelete"
""
1 487 390 E E E 1 E 1 E N "_3DText" E N "_3DFace" E E
 E E
4 0 0 0 0 0
EE E
0
1
LANG:1 0 
0
1
LANG:1 107 -microsoft windows-Arial-normal-r-normal-*-*-120-100-100-*-*-iso8859-1|-13,0,0,0,400,0,0,0,0,3,2,1,34,Arial
0 ""
485 388 548 417
T 
1
LANG:1 6 Delete
"main()
{
// Local Variables
// ---------------
	int i;
	
	dyn_int diSelectedLines;
	
	dyn_float df;
	
	dyn_string dsLine;
	dyn_string dsExceptionInfo;
	dyn_string ds;
	
// Executable Code
// ---------------
	// Give user the chance to cancel
	ChildPanelOnCentralReturn(\"vision/MessageInfo\",
														\"Confirm\",
														makeDynString(\"Are you sure you want delete the SPI communication?\", \"OK\", \"Cancel\"),
														df, ds);
																
	if (df[1]==1) {
	
		// Indicate system is busy
		fwOpenProgressBar(\"Deleting SPI\", \"In progress. Please wait...\", 1);

		fwDevice_delete($sDpName + fwDevice_HIERARCHY_SEPARATOR + ELMB_SPI_CONFIG_NAME,
										dsExceptionInfo);
			
		// Check for errors																
		if (dynlen(dsExceptionInfo) > 0) {
			fwCloseProgressBar(\"SPI deletion encountered errors\");
			fwExceptionHandling_display(dsExceptionInfo);
		} else {
			fwCloseProgressBar(\"SPI deletion completed successfully\");
		}	
	}
	
	// Return to calling routine
	return;
}" 0
 E E E
13 6
"cmdClose"
""
1 554 390 E E E 1 E 1 E N "_3DText" E N "_3DFace" E E
 E E
7 0 0 0 0 0
EE E
0
1
LANG:1 0 
0
1
LANG:1 107 -microsoft windows-Arial-normal-r-normal-*-*-120-100-100-*-*-iso8859-1|-13,0,0,0,400,0,0,0,0,3,2,1,34,Arial
0 ""
552 388 615 417
T 
1
LANG:1 5 Close
"main()
{
	PanelOff();
}" 0
 E E E
14 12
"txtComment"
""
1 10 70 E E E 1 E 1 E N "_WindowText" E N "_Window" E E
 E E
11 0 0 0 0 0
EE E
0
1
LANG:1 0 
0
1
LANG:1 107 -microsoft windows-Arial-normal-r-normal-*-*-120-100-100-*-*-iso8859-1|-13,0,0,0,400,0,0,0,0,3,2,1,34,Arial
0 ""
8 68 616 95
3 "s" 0 0 0 0 0 0 
E
E
E
20 13
"chbOpcAddressing"
""
1 26 340 E E E 1 E 1 E N "_3DText" E N "_3DFace" E E
 E E
12 0 0 0 0 0
EE E
0
2
LANG:1 0 
LANG:5 0 
0
2
LANG:1 107 -microsoft windows-Arial-normal-r-normal-*-*-120-100-100-*-*-iso8859-1|-13,0,0,0,400,0,0,0,0,3,2,1,34,Arial
LANG:5 107 -microsoft windows-Arial-normal-r-normal-*-*-120-100-100-*-*-iso8859-1|-13,0,0,0,400,0,0,0,0,3,2,1,34,Arial
0 ""
24 338 221 372
1
T 
2
LANG:1 23 Default OPC addressing?
LANG:5 23 Default OPC addressing?
 1
1
LANG:1 0 
 E  E  0 0 0 0 0
1
E E 
E"main(int button, bool state)
{
// Local Variables
// ---------------
	dyn_float df;
	
	dyn_string ds;
	
// Executable Code
// ---------------
	// Check the state of the check-box
	if (!state) {
		ChildPanelOnCentralReturn(\"vision/MessageInfo\",
															\"Question\",
															makeDynString(\"Unselecting this option you'll have to address\\nyour devices by hand.\\nAre you sure you want to do it?\", \"OK\", \"Cancel\"),
															df, ds);
		if (df[1] != 1)
			this.state(button) = true;
	}
	
	// Return to calling routine
	return;
}" 0
0
LAYER, 1 
1
LANG:1 6 Layer2
0
LAYER, 2 
1
LANG:1 6 Layer3
0
LAYER, 3 
1
LANG:1 6 Layer4
0
LAYER, 4 
1
LANG:1 6 Layer5
0
LAYER, 5 
1
LANG:1 6 Layer6
0
LAYER, 6 
1
LANG:1 6 Layer7
0
LAYER, 7 
1
LANG:1 6 Layer8
0
0