<?xml version="1.0" encoding="UTF-8"?>
<process
    name="getParameterCollection"
    targetNamespace="http://www.cern.ch/cms/csc/exsys/bpel"
    xmlns="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    xmlns:sxt="http://www.sun.com/wsbpel/2.0/process/executable/SUNExtension/Trace" 
    xmlns:sxed="http://www.sun.com/wsbpel/2.0/process/executable/SUNExtension/Editor"
    xmlns:sxat="http://www.sun.com/wsbpel/2.0/process/executable/SUNExtension/Attachment"
    xmlns:sxeh="http://www.sun.com/wsbpel/2.0/process/executable/SUNExtension/ErrorHandling"
    xmlns:tns="http://www.cern.ch/cms/csc/exsys/bpel" xmlns:sxed2="http://www.sun.com/wsbpel/2.0/process/executable/SUNExtension/Editor2" xmlns:ns0="http://www.cern.ch/cms/csc/exsys/data">
    <import namespace="http://www.cern.ch/cms/csc/exsys/wsdl" location="getParameterCollection.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"/>
    <import namespace="http://www.cern.ch/cms/csc/exsys/wsdl" location="getParameter.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"/>
    <partnerLinks>
        <partnerLink name="getParameterPartnerLink" xmlns:tns="http://www.cern.ch/cms/csc/exsys/wsdl" partnerLinkType="tns:getParameter" partnerRole="getParameterPortTypeRole"/>
        <partnerLink name="getParameterCollectionPartnerLink" xmlns:tns="http://www.cern.ch/cms/csc/exsys/wsdl" partnerLinkType="tns:getParameterCollection" myRole="getParameterCollectionPortTypeRole"/>
    </partnerLinks>
    <variables>
        <variable name="GetParameterCollectionOperationOut" xmlns:tns="http://www.cern.ch/cms/csc/exsys/wsdl" messageType="tns:getParameterCollectionOperationResponse"/>
        <variable name="GetParameterCollectionOperationIn" xmlns:tns="http://www.cern.ch/cms/csc/exsys/wsdl" messageType="tns:getParameterCollectionOperationRequest"/>
    </variables>
    <sequence>
        <receive name="getParameterCollectionReceive" createInstance="yes" partnerLink="getParameterCollectionPartnerLink" operation="getParameterCollectionOperation" xmlns:tns="http://www.cern.ch/cms/csc/exsys/wsdl" portType="tns:getParameterCollectionPortType" variable="GetParameterCollectionOperationIn"/>
        <assign name="resetReply">
            <copy>
                <from>0</from>
                <to variable="GetParameterCollectionOperationOut" part="saved"/>
            </copy>
        </assign>
        <forEach name="ForEachParameter" parallel="no" counterName="ForEachParameterCounter">
            <startCounterValue>1</startCounterValue>
            <finalCounterValue>count($GetParameterCollectionOperationIn.collection/ns0:parameter)</finalCounterValue>
            <scope name="EachParameterScope">
                <variables>
                    <variable name="GetParameterOperationOut" xmlns:tns="http://www.cern.ch/cms/csc/exsys/wsdl" messageType="tns:getParameterOperationResponse"/>
                    <variable name="GetParameterOperationIn" xmlns:tns="http://www.cern.ch/cms/csc/exsys/wsdl" messageType="tns:getParameterOperationRequest"/>
                </variables>
                <sequence name="EachParameterSequence">
                    <assign name="nextParameter">
                        <copy>
                            <from>$GetParameterCollectionOperationIn.collection/ns0:parameter[position() = $ForEachParameterCounter]</from>
                            <to variable="GetParameterOperationIn" part="parameter"/>
                        </copy>
                        <copy>
                            <from>$GetParameterCollectionOperationIn.collection/ns0:source</from>
                            <to variable="GetParameterOperationIn" part="source"/>
                        </copy>
                    </assign>
                    <invoke name="getParameterInvoke" partnerLink="getParameterPartnerLink" operation="getParameterOperation" xmlns:tns="http://www.cern.ch/cms/csc/exsys/wsdl" portType="tns:getParameterPortType" inputVariable="GetParameterOperationIn" outputVariable="GetParameterOperationOut"/>
                    <if name="IfSuccess">
                        <condition>$GetParameterOperationOut.result</condition>
                        <assign name="IncReply">
                            <copy>
                                <from>$GetParameterCollectionOperationOut.saved + 1</from>
                                    <to variable="GetParameterCollectionOperationOut" part="saved"/>
                            </copy>
                        </assign>
                    </if>
                </sequence>
            </scope>
        </forEach>
        <reply name="getParameterCollectionReply" partnerLink="getParameterCollectionPartnerLink" operation="getParameterCollectionOperation" xmlns:tns="http://www.cern.ch/cms/csc/exsys/wsdl" portType="tns:getParameterCollectionPortType" variable="GetParameterCollectionOperationOut"/>
    </sequence>
</process>
