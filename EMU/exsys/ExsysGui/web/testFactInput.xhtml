<?xml version='1.0' encoding='UTF-8' ?>

<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:icecore="http://www.icefaces.org/icefaces/core"
    xmlns:ace="http://www.icefaces.org/icefaces/components"
    xmlns:ice="http://www.icesoft.com/icefaces/component"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    template="resources/main.xhtml"
    xmlns:component="http://java.sun.com/jsf/composite/component">

    <ui:define name="menu">
        
    </ui:define>

    <ui:define name="pageTitle">
        <h:outputText value="Testing Fact Collection input services"/>
    </ui:define>

    <ui:define name="content">
        <ice:panelGroup styleClass="sectionTitle">
            POST service
        </ice:panelGroup>
        <ice:form>
            <table width="100%" cellpadding="5" cellspacing="5">
                <tr>
                    <td colspan="2">
                        URL:
                        <input id="postUrl" type="text" value="/ExsysGui/factcollectioninput" size="50"/>
                        <input id="postUrlTestButton" type="button" value="Test URL"/>
                    </td>
                </tr>
                <tr>
                    <td width="50%">Type in or paste a Fact Collection XML below:</td>
                    <td width="50%">Result:</td>
                </tr>
                <tr>
                    <td width="50%">
                        <textarea id="postXml" style="width: 100%; height: 400px"></textarea>
                    </td>
                    <td width="50%">
                        <div id="postResult" style="width: 100%; height: 400px; overflow: scroll; border-style: inset; border-width: 2px; padding: 5px; border-color: white"/>
                    </td>
                </tr>
                <tr>
                    <td width="50%">
                        <input id="postButton" type="button" value="Send"/>
                    </td>
                    <td width="50%">
                        <input id="postClearButton" type="button" value="Clear"/>
                    </td>
                </tr>
            </table>

            <script type="text/javascript">
                // <![CDATA[
                jQuery(document).ready( function () {

                    jQuery("#postUrlTestButton").click(function() {
                        window.open(jQuery("#postUrl").val());
                    });

                    jQuery("#postClearButton").click(function() {
                        jQuery("#postResult").html("").css("border-color", "white");
                    });

                    jQuery("#postButton").click(function() {
                        var url = jQuery("#postUrl").val();
                        var xml = jQuery("#postXml").val();
                        jQuery.ajax({
                          type: 'POST',
                          url: url,
                          data: xml,
                          async: false,
                          success:
                              function(res) {
                                 jQuery("#postResult").html(res).css("border-color", "green");
                              },
                          error:
                              function(xhr, status, error) {
                                 jQuery("#postResult").html(xhr.responseText).css("border-color", "red");
                              }
                        });
                    });

                });
                // ]]>
            </script>

        </ice:form>
    </ui:define>

</ui:composition>
